<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"leetao50.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.11.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="数据流流是在一段时间内到达的数据。数据流可以是任何东西，比如变量、用户输入、属性、缓存、数据结构，甚至异常等。 考虑一下鼠标单击事件的x和y位置序列的例子。假设用户已经按顺序点击了位置（12,15）、（10,12）、（15,20）和（17,15）。下图显示了值是如何在一段时间内到达的。正如您所看到的，流在值发生时即异步地发出。 值并不是流发出的唯一东西，流可以在用户关闭窗口或应用程序时完成，或者程">
<meta property="og:type" content="article">
<meta property="og:title" content="Angular Observable 简介">
<meta property="og:url" content="https://leetao50.github.io/2023/04/14/angular/observable/Angular-Observable-%E7%AE%80%E4%BB%8B/index.html">
<meta property="og:site_name" content="InfoPool">
<meta property="og:description" content="数据流流是在一段时间内到达的数据。数据流可以是任何东西，比如变量、用户输入、属性、缓存、数据结构，甚至异常等。 考虑一下鼠标单击事件的x和y位置序列的例子。假设用户已经按顺序点击了位置（12,15）、（10,12）、（15,20）和（17,15）。下图显示了值是如何在一段时间内到达的。正如您所看到的，流在值发生时即异步地发出。 值并不是流发出的唯一东西，流可以在用户关闭窗口或应用程序时完成，或者程">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-04-14T03:51:36.000Z">
<meta property="article:modified_time" content="2023-04-25T09:01:38.537Z">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://leetao50.github.io/2023/04/14/angular/observable/Angular-Observable-%E7%AE%80%E4%BB%8B/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://leetao50.github.io/2023/04/14/angular/observable/Angular-Observable-%E7%AE%80%E4%BB%8B/","path":"2023/04/14/angular/observable/Angular-Observable-简介/","title":"Angular Observable 简介"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Angular Observable 简介 | InfoPool</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">InfoPool</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">私人信息记录</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%B5%81"><span class="nav-number">1.</span> <span class="nav-text">数据流</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B"><span class="nav-number">2.</span> <span class="nav-text">响应式编程</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFRxJS"><span class="nav-number">3.</span> <span class="nav-text">什么是RxJS</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFAngular%E4%B8%AD%E7%9A%84%E5%8F%AF%E8%A7%82%E5%AF%9F%E8%80%85-Observable"><span class="nav-number">4.</span> <span class="nav-text">什么是Angular中的可观察者(Observable)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%B0%81%E6%98%AF%E8%A7%82%E5%AF%9F%E8%80%85-subscribers"><span class="nav-number">5.</span> <span class="nav-text">谁是观察者(subscribers)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA-Observable-%E5%AF%B9%E8%B1%A1"><span class="nav-number">6.</span> <span class="nav-text">创建 Observable 对象</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%A2%E9%98%85%E5%8F%AF%E8%A7%82%E6%B5%8B%E5%AF%B9%E8%B1%A1"><span class="nav-number">7.</span> <span class="nav-text">订阅可观测对象</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E9%97%B4%E9%9A%94"><span class="nav-number">8.</span> <span class="nav-text">添加间隔</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Error-%E4%BA%8B%E4%BB%B6"><span class="nav-number">9.</span> <span class="nav-text">Error 事件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%8C%E6%88%90%E4%BA%8B%E4%BB%B6"><span class="nav-number">10.</span> <span class="nav-text">完成事件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Observable-%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">11.</span> <span class="nav-text">Observable 操作符</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%96%E6%B6%88%E8%AE%A2%E9%98%85Observable"><span class="nav-number">12.</span> <span class="nav-text">取消订阅Observable</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">13.</span> <span class="nav-text">总结</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name"></p>
  <div class="site-description" itemprop="description">记录信息来源网络，内容只为方便查找，非公开信息，非请勿入</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">35</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://leetao50.github.io/2023/04/14/angular/observable/Angular-Observable-%E7%AE%80%E4%BB%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="InfoPool">
      <meta itemprop="description" content="记录信息来源网络，内容只为方便查找，非公开信息，非请勿入">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Angular Observable 简介 | InfoPool">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Angular Observable 简介
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-04-14 11:51:36" itemprop="dateCreated datePublished" datetime="2023-04-14T11:51:36+08:00">2023-04-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-04-25 17:01:38" itemprop="dateModified" datetime="2023-04-25T17:01:38+08:00">2023-04-25</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="数据流"><a href="#数据流" class="headerlink" title="数据流"></a>数据流</h1><p>流是在一段时间内到达的数据。数据流可以是任何东西，比如变量、用户输入、属性、缓存、数据结构，甚至异常等。</p>
<p>考虑一下鼠标单击事件的x和y位置序列的例子。假设用户已经按顺序点击了位置（12,15）、（10,12）、（15,20）和（17,15）。下图显示了值是如何在一段时间内到达的。正如您所看到的，流在值发生时即异步地发出。</p>
<p>值并不是流发出的唯一东西，流可以在用户关闭窗口或应用程序时完成，或者程序发生错误时，导致流关闭。任何时间，流都可能发出以下三种东西中的任何一种。</p>
<ul>
<li>Value：即流中的下一个值</li>
<li>Complete：流已结束</li>
<li>Error：错误已停止流</li>
</ul>
<p>正如前面所说，数据流可以是任何东西。例如</p>
<ul>
<li>鼠标点击或鼠标悬停事件</li>
<li>键盘事件，如键被按下、键被抬起、按键等</li>
<li>表单事件，如值被跟新等</li>
<li>HTTP请求后到达的数据</li>
<li>用户通知</li>
</ul>
<p>现在，我们已经了解了什么是数据流，让我们看看什么是响应式编程</p>
<h1 id="响应式编程"><a href="#响应式编程" class="headerlink" title="响应式编程"></a>响应式编程</h1><p>响应式编程就是创建数据流，触发值，错误或完成信号。修改、转换或对数据流做一些有用的操作。</p>
<h1 id="什么是RxJS"><a href="#什么是RxJS" class="headerlink" title="什么是RxJS"></a>什么是RxJS</h1><p>RxJS（Reactive Extensions Library for JavaScript）是一个JavaScript库，它允许我们使用异步数据流</p>
<p>Angular在其框架中大量使用RxJS库来实现响应式编程。使用响应式编程的一些示例如下：</p>
<ul>
<li>Angular中响应HTTP请求</li>
<li>Angular中表单中值&#x2F;状态变更</li>
<li>Router和Forms模块使用可观察性来监听和响应用户输入事件</li>
<li>通过自定义事件从子组件发送observable输出数据到父组件</li>
<li>HTTP模块使用Observable来处理AJAX请求和响应</li>
</ul>
<p>RxJs有两个主要对象</p>
<ul>
<li>可观察者(Observable)</li>
<li>观察者（Observers&#x2F;Subscribers)</li>
</ul>
<h1 id="什么是Angular中的可观察者-Observable"><a href="#什么是Angular中的可观察者-Observable" class="headerlink" title="什么是Angular中的可观察者(Observable)"></a>什么是Angular中的可观察者(Observable)</h1><p>Observable是一个将普通数据流转换为可观测数据流的函数。您可以将Observable看作是普通数据流的包装器。</p>
<p>Observable流或简单Observable使用异步流发送值内容，当流发送完成时，它会发出完成信号，当流出错时，他会发出错误信号。</p>
<p>Observable是声明性的，定义了一个Observable函数，就像定义其他变量一样。只有当有人订阅了observable时，它才会开始发出值。</p>
<h1 id="谁是观察者-subscribers"><a href="#谁是观察者-subscribers" class="headerlink" title="谁是观察者(subscribers)"></a>谁是观察者(subscribers)</h1><p>“Observable”本身是无用的，除非有人消耗了Observable发出的值。我们称他们为观察者或订阅者。观察者使用回调与Observable通信。</p>
<p>观察者必须订阅可观察的事物，才能从可观察的东西中获得值。在订阅时，它可以选择性地传递这三个回调。next（）、error（）和complete（）</p>
<p>一旦观察者或消费者订阅了该值，可观察对象就开始发出该值。</p>
<p>每当值到达流中时，observable就会调用next()回调。它将该值作为参数传递给next()回调。如果发生错误，则调用error()回调。当流完成时，它调用complete()回调。</p>
<ul>
<li>观察者&#x2F;订阅者订阅Observables</li>
<li>观察者&#x2F;订阅者在订阅时向observable注册三个回调。next()、error()和complete()</li>
<li>所有三个回调都是可选的</li>
<li>观察器通过next()回调从观察器接收数据</li>
<li>他们还通过error()和complete()回调从Observable接收错误和完成事件</li>
</ul>
<h1 id="创建-Observable-对象"><a href="#创建-Observable-对象" class="headerlink" title="创建 Observable 对象"></a>创建 Observable 对象</h1><p>有几种方法可以在angular中创建可观察的对象。最简单的是使用Observable构造函数。observable构造函数以subscriber作为其参数。subscriber将在这个observable的subscribe()方法执行时运行。</p>
<p>以下示例创建了一个数字流1、2、3、4、5的observable</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">obs = <span class="keyword">new</span> <span class="title class_">Observable</span>(<span class="function">(<span class="params">observer</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Observable starts&quot;</span>)</span><br><span class="line">     observer.<span class="title function_">next</span>(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">     observer.<span class="title function_">next</span>(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">     observer.<span class="title function_">next</span>(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">     observer.<span class="title function_">next</span>(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">     observer.<span class="title function_">next</span>(<span class="string">&quot;5&quot;</span>)</span><br><span class="line">   &#125;)</span><br></pre></td></tr></table></figure>

<p>变量obs现在属于observable类型。</p>
<p>上面的例子声明obs为observable，但没有实例化它。要使observable发出值，我们需要订阅它。</p>
<p>在上面的例子中，我们使用了Observable构造函数来创建Observable。RxJS库有许多可用的运算符，这使得创建可观察对象变得容易。这些运算符帮助我们从数组、字符串、promise、任何可迭代的内容等,创建可观察的内容。</p>
<h1 id="订阅可观测对象"><a href="#订阅可观测对象" class="headerlink" title="订阅可观测对象"></a>订阅可观测对象</h1><p>我们通过调用observable上的subscribe方法来订阅它。我们可以选择性地包括三个回调next()、error()和complete()，如下所示</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">ngOnInit</span>(<span class="params"></span>) &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">obs</span>.<span class="title function_">subscribe</span>(</span><br><span class="line">      <span class="function"><span class="params">val</span> =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(val) &#125;, <span class="comment">//next callback</span></span><br><span class="line">      <span class="function"><span class="params">error</span> =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;error&quot;</span>) &#125;, <span class="comment">//error callback</span></span><br><span class="line">      <span class="function">() =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Completed&quot;</span>) &#125; <span class="comment">//complete callback</span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="添加间隔"><a href="#添加间隔" class="headerlink" title="添加间隔"></a>添加间隔</h1><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">obs = <span class="keyword">new</span> <span class="title class_">Observable</span>(<span class="function">(<span class="params">observer</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Observable starts&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">next</span>(<span class="string">&quot;1&quot;</span>) &#125;, <span class="number">1000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">next</span>(<span class="string">&quot;2&quot;</span>) &#125;, <span class="number">2000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">next</span>(<span class="string">&quot;3&quot;</span>) &#125;, <span class="number">3000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">next</span>(<span class="string">&quot;4&quot;</span>) &#125;, <span class="number">4000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">next</span>(<span class="string">&quot;5&quot;</span>) &#125;, <span class="number">5000</span>);</span><br><span class="line">    </span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<h1 id="Error-事件"><a href="#Error-事件" class="headerlink" title="Error 事件"></a>Error 事件</h1><p>如前所述，Observable也会发出误差。这是通过调用error（）回调并传递error对象来完成的。Observable在发出错误信号后停止。因此，永远不会发射值4和5。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">obs = <span class="keyword">new</span> <span class="title class_">Observable</span>(<span class="function">(<span class="params">observer</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Observable starts&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">next</span>(<span class="string">&quot;1&quot;</span>) &#125;, <span class="number">1000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">next</span>(<span class="string">&quot;2&quot;</span>) &#125;, <span class="number">2000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">next</span>(<span class="string">&quot;3&quot;</span>) &#125;, <span class="number">3000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">error</span>(<span class="string">&quot;error emitted&quot;</span>) &#125;, <span class="number">3500</span>);    <span class="comment">//sending error event. observable stops here</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">next</span>(<span class="string">&quot;4&quot;</span>) &#125;, <span class="number">4000</span>);          <span class="comment">//this code is never called</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">next</span>(<span class="string">&quot;5&quot;</span>) &#125;, <span class="number">5000</span>);</span><br><span class="line">    </span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<h1 id="完成事件"><a href="#完成事件" class="headerlink" title="完成事件"></a>完成事件</h1><p> 在发出完成信号后，Observable就会停止，因此，永远不会发射值4和5。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">  obs = <span class="keyword">new</span> <span class="title class_">Observable</span>(<span class="function">(<span class="params">observer</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Observable starts&quot;</span>)</span><br><span class="line"> </span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">next</span>(<span class="string">&quot;1&quot;</span>) &#125;, <span class="number">1000</span>);</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">next</span>(<span class="string">&quot;2&quot;</span>) &#125;, <span class="number">2000</span>);</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">next</span>(<span class="string">&quot;3&quot;</span>) &#125;, <span class="number">3000</span>);</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">complete</span>() &#125;, <span class="number">3500</span>);   <span class="comment">//sending complete event. observable stops here</span></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">next</span>(<span class="string">&quot;4&quot;</span>) &#125;, <span class="number">4000</span>);    <span class="comment">//this code is never called</span></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; observer.<span class="title function_">next</span>(<span class="string">&quot;5&quot;</span>) &#125;, <span class="number">5000</span>);</span><br><span class="line">  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h1 id="Observable-操作符"><a href="#Observable-操作符" class="headerlink" title="Observable 操作符"></a>Observable 操作符</h1><p>操作符是对Observable进行操作并返回新Observable的函数。</p>
<p>Observable的能力来自于操作符，您可以使用操作符来操作传入的Observable对象，对其进行过滤，将其与另一个Observable对象合并，更改值或订阅另一个Observable对象。</p>
<p>也可以使用管道将操作符链接起来。链中的每个操作符都可以从上一个操作符中获得Observable。它对其进行修改并创建一个新的Observable，该Observable成为下一个Observable的输入。</p>
<p>以下示例显示了filer和map运算符使用管道链接到一起，filter运算符删除所有小于等于2的数据，map运算符将该值乘以2。<br>输入流为[1，2，3，4，5]，而输出流为[6，8，10]。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">obs.<span class="title function_">pipe</span>(</span><br><span class="line"> obs = <span class="keyword">new</span> <span class="title class_">Observable</span>(<span class="function">(<span class="params">observer</span>) =&gt;</span> &#123;</span><br><span class="line">    observer.<span class="title function_">next</span>(<span class="number">1</span>)</span><br><span class="line">    observer.<span class="title function_">next</span>(<span class="number">2</span>)</span><br><span class="line">    observer.<span class="title function_">next</span>(<span class="number">3</span>)</span><br><span class="line">    observer.<span class="title function_">next</span>(<span class="number">4</span>)</span><br><span class="line">    observer.<span class="title function_">next</span>(<span class="number">5</span>)</span><br><span class="line">    observer.<span class="title function_">complete</span>()</span><br><span class="line">  &#125;).<span class="title function_">pipe</span>(</span><br><span class="line">    <span class="title function_">filter</span>(<span class="function"><span class="params">data</span> =&gt;</span> data &gt; <span class="number">2</span>),   <span class="comment">//filter Operator</span></span><br><span class="line">    <span class="title function_">map</span>(<span class="function">(<span class="params">val</span>) =&gt;</span> &#123;<span class="keyword">return</span> val <span class="keyword">as</span> <span class="built_in">number</span> * <span class="number">2</span>&#125;), <span class="comment">//map operator</span></span><br><span class="line">  )</span><br></pre></td></tr></table></figure>

<h1 id="取消订阅Observable"><a href="#取消订阅Observable" class="headerlink" title="取消订阅Observable"></a>取消订阅Observable</h1><p>当我们不再需要observable时，我们需要取消订阅以关闭它。如果不取消订阅，可能会导致内存泄漏和性能下降。<br>要从可观察到的订阅中取消订阅，我们需要对订阅调用Unsubscribe（）方法。它将清理所有侦听器并释放内存。要做到这一点，首先，创建一个变量来存储订阅。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">obs</span>: <span class="title class_">Subscription</span>;</span><br></pre></td></tr></table></figure>

<p>将订阅分配给obs变量</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">obs</span> = <span class="variable language_">this</span>.<span class="property">src</span>.<span class="title function_">subscribe</span>(<span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Received &quot;</span> + <span class="variable language_">this</span>.<span class="property">id</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>在ngOnDestroy方法中调用unsubscribe()方法。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">ngOnDestroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">obs</span>.<span class="title function_">unsubscribe</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当我们销毁组件时，可观察到的内容将被取消订阅并清除。但是，您不必每次订阅都取消订阅。例如，发出完整信号的可观测对象，自动关闭。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>响应式编程就是对流进行编程。RxJS库将响应式编程引入了Angular。使用RxJs，我们可以创建一个可观测对象，它可以向观测对象的订阅者发出值、错误和完成信号。</p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/04/13/angular/Angular%E8%A3%85%E9%A5%B0%E5%99%A8/" rel="prev" title="Angular装饰器">
                  <i class="fa fa-chevron-left"></i> Angular装饰器
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/04/25/angular/observable/%E4%BB%8EAngular%E4%B8%AD%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E3%80%81%E6%95%B0%E7%BB%84%E5%92%8C%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA%E5%8F%AF%E8%A7%82%E5%AF%9F%E5%AF%B9%E8%B1%A1/" rel="next" title="从Angular中的字符串、数组和对象创建可观察对象">
                  从Angular中的字符串、数组和对象创建可观察对象 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"></span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
